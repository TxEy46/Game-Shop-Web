<mat-toolbar class="toolbar">
  <div class="toolbar-left"><span>üéÆ Game Shop</span></div>

  <div class="toolbar-center" *ngIf="showSearch">
    <div class="search-container">
      <div class="search-controls">
        <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏° -->
        <input 
          type="text" 
          placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏°..." 
          [(ngModel)]="query" 
          (input)="onSearch()"
          class="search-input"
        >

        <!-- Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó -->
        <select 
          [(ngModel)]="selectedCategory" 
          (change)="onSearch()" 
          class="category-select"
        >
          <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
          <option *ngFor="let category of categories" [value]="category.name">
            {{ category.name }}
          </option>
        </select>
      </div>
      
      <!-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
      <div class="search-results" *ngIf="results.length">
        <div class="search-header">
          <span>‡∏û‡∏ö {{ results.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
          <button (click)="clearSearch()" class="clear-results-btn">‡∏•‡πâ‡∏≤‡∏á</button>
        </div>
        <div 
          class="search-item" 
          *ngFor="let game of results" 
          (click)="goToGameDetail(game.id)"
        >
          <img [src]="game.image_url" alt="{{ game.name }}" class="game-image">
          <div class="game-info">
            <span class="game-name">{{ game.name }}</span>
            <!-- ‡πÉ‡∏ä‡πâ category_name ‡∏ï‡∏≤‡∏° interface -->
            <!-- <span class="game-category">{{ game.category_name }}</span> -->
            <span class="game-price">{{ game.price | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toolbar-right">
    <div class="cart-container" [matMenuTriggerFor]="cartMenu">
      üõí <span class="cart-count">{{ getCartCount() }}</span>
    </div>
    <div class="wallet" [matMenuTriggerFor]="userMenu">
      <img class="profile-pic" [src]="getAvatarUrl()" alt="Profile">
      <span class="balance">{{ getUserBalance() | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</span>
    </div>
  </div>
</mat-toolbar>

<!-- ‡∏™‡πà‡∏ß‡∏ô cart menu ‡πÅ‡∏•‡∏∞ user menu ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° -->
<mat-menu #cartMenu="matMenu" class="cart-menu custom-menu">
  <ng-container *ngIf="cart.length; else emptyCart">
    <div class="cart-items-wrapper">
      <div *ngFor="let item of cart" class="cart-item">
        <img [src]="item.image_url" alt="{{ item.name }}">
        <div class="item-info">
          <span class="item-name">{{ item.name }}</span>
          <span class="item-price">{{ (item.price * item.quantity) | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</span>
        </div>
        <div class="item-quantity">x{{ item.quantity }}</div>
        <div class="remove-btn" (click)="removeFromCart(item.gameId)">‡∏•‡∏ö</div>
      </div>
    </div>

    <div class="cart-footer">
      <div class="cart-total">
        ‡∏£‡∏ß‡∏°: {{ getCartTotal() | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó
      </div>
      <button mat-raised-button (click)="goToCheckout()">‡πÑ‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
    </div>
  </ng-container>

  <ng-template #emptyCart>
    <div class="empty-cart">
      üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á
    </div>
  </ng-template>
</mat-menu>

<mat-menu #userMenu="matMenu" class="custom-menu user-menu">
  <button mat-menu-item (click)="goToHome()">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
  <button mat-menu-item (click)="goToProfile()">üë§ ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</button>
  <button mat-menu-item (click)="goToWallet()">üí∞ ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡πÄ‡∏á‡∏¥‡∏ô</button>
  <button mat-menu-item (click)="goToLibrary()">üéÆ ‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏°</button>
  <button mat-menu-item (click)="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
</mat-menu>