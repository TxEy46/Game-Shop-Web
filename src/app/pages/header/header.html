<mat-toolbar class="toolbar">
  <div class="toolbar-left">
    <span>üéÆ Game Shop</span>
  </div>

  <div class="toolbar-center" *ngIf="showSearch">
    <div class="search-container">
      <input type="text" placeholder="Search games..." [(ngModel)]="query" (input)="onSearch()">
      <div class="search-results" *ngIf="results.length">
        <div class="search-item" *ngFor="let game of results" (click)="goToGameDetail(game.id)">
          <img [src]="game.image_url" alt="{{ game.name }}">
          <span>{{ game.name }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="toolbar-right">
    <!-- Cart -->
    <div class="cart-container" *ngIf="user" [matMenuTriggerFor]="cartMenu">
      üõí
      <span class="cart-count">{{ getCartCount() }}</span>
    </div>

    <!-- Wallet -->
    <div class="wallet" *ngIf="user" [matMenuTriggerFor]="userMenu">
      <img class="profile-pic"
           [src]="user.avatar_url ? 'http://localhost:3000' + user.avatar_url : '/assets/profile-placeholder.png'"
           alt="Profile">
      <span class="balance">{{ user.userBalance | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</span>
    </div>
  </div>
</mat-toolbar>

<mat-menu #cartMenu="matMenu" class="custom-menu horizontal-cart" xPosition="before">
    <ng-container *ngIf="cart.length; else emptyCart">
        <div class="cart-items-wrapper">
            <div class="cart-item" *ngFor="let item of cart">
                <img [src]="item.image_url" alt="{{ item.name }}">
                <div class="item-info">
                    <span class="item-name">{{ item.name }}</span>
                    <span class="item-price">{{ (item.price * item.quantity) | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</span>
                </div>
                <p class="remove-btn" (click)="removeFromCart(item.gameId)">‡∏•‡∏ö</p>
            </div>
        </div>

        <div class="cart-footer">
            <div class="cart-total">‡∏£‡∏ß‡∏°: {{ getCartTotal() | number:'1.2-2' }} ‡∏ö‡∏≤‡∏ó</div>
            <button mat-raised-button color="accent" (click)="goToCheckout()">‡πÑ‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
        </div>
    </ng-container>

    <ng-template #emptyCart>
        <div class="empty-cart">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</div>
    </ng-template>
</mat-menu>

<!-- User Menu -->
<mat-menu #userMenu="matMenu" class="custom-menu">
    <button mat-menu-item (click)="goToHome()"><span>üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></button>
    <button mat-menu-item (click)="goToProfile()"><span>üë§ ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</span></button>
    <button mat-menu-item (click)="goToWallet()"><span>üí∞ ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡πÄ‡∏á‡∏¥‡∏ô</span></button>
    <button mat-menu-item (click)="goToLibrary()"><span>üéÆ ‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏°</span></button>
    <button mat-menu-item (click)="logout()"><span>üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span></button>
</mat-menu>