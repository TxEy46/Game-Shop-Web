<mat-toolbar class="toolbar">
  <div class="toolbar-left">
    <span>ğŸ® Game Shop</span>
  </div>

  <div class="toolbar-center" *ngIf="showSearch">
    <div class="search-container">
      <input type="text" placeholder="Search games..." [(ngModel)]="query" (input)="onSearch()">
      <div class="search-results" *ngIf="results.length">
        <div class="search-item" *ngFor="let game of results" (click)="goToGameDetail(game.id)">
          <img [src]="game.image_url" alt="{{ game.name }}">
          <span>{{ game.name }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="toolbar-right" *ngIf="user">
    <!-- Cart -->
    <div class="cart-container" [matMenuTriggerFor]="cartMenu">
      ğŸ›’ <span class="cart-count">{{ getCartCount() }}</span>
    </div>

    <!-- Wallet + Username -->
    <div class="wallet" [matMenuTriggerFor]="userMenu">
      <img *ngIf="user" class="profile-pic" [src]="getAvatarUrl()" alt="Profile">
      <span class="balance">{{ user.wallet_balance | number:'1.2-2' }} à¸šà¸²à¸—</span>
      <!-- à¸¥à¸š username à¸­à¸­à¸à¹€à¸à¸£à¸²à¸°à¹„à¸¡à¹ˆà¸¡à¸µà¹ƒà¸™ template à¹€à¸”à¸´à¸¡ -->
    </div>
  </div>
</mat-toolbar>

<!-- Cart Menu -->
<mat-menu #cartMenu="matMenu">
  <ng-container *ngIf="cart.length; else emptyCart">
    <div *ngFor="let item of cart" class="cart-item">
      <img [src]="item.image_url" alt="{{ item.name }}">
      <span>{{ item.name }} x{{ item.quantity }}</span>
      <span>{{ (item.price * item.quantity) | number:'1.2-2' }} à¸šà¸²à¸—</span>
      <button (click)="removeFromCart(item.gameId)">à¸¥à¸š</button>
    </div>
    <div class="cart-total">à¸£à¸§à¸¡: {{ getCartTotal() | number:'1.2-2' }} à¸šà¸²à¸—</div>
    <button (click)="goToCheckout()">à¹„à¸›à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™</button>
  </ng-container>
  <ng-template #emptyCart>
    <div>à¸•à¸°à¸à¸£à¹‰à¸²à¸§à¹ˆà¸²à¸‡</div>
  </ng-template>
</mat-menu>

<!-- User Menu -->
<mat-menu #userMenu="matMenu">
  <button mat-menu-item (click)="goToHome()">ğŸ  à¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸</button>
  <button mat-menu-item (click)="goToProfile()">ğŸ‘¤ à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ</button>
  <button mat-menu-item (click)="goToWallet()">ğŸ’° à¸à¸£à¸°à¹€à¸›à¹‹à¸²à¹€à¸‡à¸´à¸™</button>
  <button mat-menu-item (click)="goToLibrary()">ğŸ® à¸„à¸¥à¸±à¸‡à¹€à¸à¸¡</button>
  <button mat-menu-item (click)="logout()">ğŸšª à¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸°à¸šà¸š</button>
</mat-menu>