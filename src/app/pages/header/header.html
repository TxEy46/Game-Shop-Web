<mat-toolbar class="toolbar">
  <div class="toolbar-left"><span>ğŸ® Game Shop</span></div>

  <div class="toolbar-center" *ngIf="showSearch">
    <div class="search-container">
      <input type="text" placeholder="Search games..." [(ngModel)]="query" (input)="onSearch()">
      <div class="search-results" *ngIf="results.length">
        <div class="search-item" *ngFor="let game of results" (click)="goToGameDetail(game.id)">
          <img [src]="game.image_url" alt="{{ game.name }}">
          <span>{{ game.name }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="toolbar-right">
    <div class="cart-container" [matMenuTriggerFor]="cartMenu">ğŸ›’ <span class="cart-count">{{ getCartCount() }}</span>
    </div>
    <div class="wallet" [matMenuTriggerFor]="userMenu">
      <img class="profile-pic" [src]="getAvatarUrl()" alt="Profile">
      <!-- à¹à¸ªà¸”à¸‡à¹€à¸‡à¸´à¸™à¸ˆà¸²à¸ getUserBalance() -->
      <span class="balance">{{ getUserBalance() | number:'1.2-2' }} à¸šà¸²à¸—</span>
    </div>
  </div>
</mat-toolbar>

<mat-menu #cartMenu="matMenu" class="cart-menu custom-menu">
  <ng-container *ngIf="cart.length; else emptyCart">
    <div class="cart-items-wrapper">
      <div *ngFor="let item of cart" class="cart-item">
        <img [src]="item.image_url" alt="{{ item.name }}">
        <div class="item-info">
          <span class="item-name">{{ item.name }}</span>
          <span class="item-price">{{ (item.price * item.quantity) | number:'1.2-2' }} à¸šà¸²à¸—</span>
        </div>
        <div class="item-quantity">x{{ item.quantity }}</div>
        <div class="remove-btn" (click)="removeFromCart(item.gameId)">à¸¥à¸š</div>
      </div>
    </div>

    <div class="cart-footer">
      <div class="cart-total">
        à¸£à¸§à¸¡: {{ getCartTotal() | number:'1.2-2' }} à¸šà¸²à¸—
      </div>
      <button mat-raised-button (click)="goToCheckout()">à¹„à¸›à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™</button>
    </div>
  </ng-container>

  <ng-template #emptyCart>
    <div class="empty-cart">
      ğŸ›’ à¸•à¸°à¸à¸£à¹‰à¸²à¸§à¹ˆà¸²à¸‡
    </div>
  </ng-template>
</mat-menu>


<mat-menu #userMenu="matMenu" class="custom-menu user-menu">
  <button mat-menu-item (click)="goToHome()">ğŸ  à¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸</button>
  <button mat-menu-item (click)="goToProfile()">ğŸ‘¤ à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ</button>
  <button mat-menu-item (click)="goToWallet()">ğŸ’° à¸à¸£à¸°à¹€à¸›à¹‹à¸²à¹€à¸‡à¸´à¸™</button>
  <button mat-menu-item (click)="goToLibrary()">ğŸ® à¸„à¸¥à¸±à¸‡à¹€à¸à¸¡</button>
  <button mat-menu-item (click)="logout()">ğŸšª à¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸°à¸šà¸š</button>
</mat-menu>
